# React Simplified

Implements automatic state management for React components using
[ES6 Proxies](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy) through the [@nx-js/observer-util](https://github.com/nx-js/observer-util) library. Supports shared data between components that rerenders affected components when altered. Additional features:

* Auto-binds component methods
* Calls `componentWillUnmount` and `componentDidMount` when `props.match.params` change for easier [react-router](https://www.npmjs.com/package/react-router) usage
* Static methods `instance()` and `instances()` that simplifies component static
method implementations
* Can use lifecycle hooks `mounted`, `updated` and `beforeUnmount` instead of `componentDidMount`, `componentDidUpdate` and `componentWillUnmount`.
* Works with React Native (although you need an updated JavaScriptCore for Android. Please track this issue: https://github.com/facebook/react-native/issues/19737)

## Installation

```sh
npm install react-simplified
```

## Examples
Example showing updated date and time:
```jsx
import React from 'react';
import {Component} from 'react-simplified';
import ReactDOM from 'react-dom';

class App extends Component {
  date = new Date();

  render() {
    return <div>{this.date.toString()}</div>;
  }

  mounted() {
    setInterval(() => this.date = new Date(), 1000);
  }
}

ReactDOM.render(<App />, document.getElementById('root'));
```

Example with data shared between two components:
```jsx
import React from 'react';
import {Component, sharedComponentData} from 'react-simplified';
import ReactDOM from 'react-dom';

const shared = sharedComponentData({date: new Date()});
setInterval(() => (shared.date = new Date()), 1000);

class Component1 extends Component {
  render() {
    return <div>{shared.date.toString()}</div>;
  }
}

class Component2 extends Component {
  render() {
    return <div>{shared.date.toString()}</div>;
  }
}

ReactDOM.render(
  <div>
    <Component1 />
    <Component2 />
  </div>,
  document.getElementById('root')
);
```

A larger example where a class instance, simulating loading and storing data, is shared and used by two components:
```jsx
import React from 'react';
import {Component, sharedComponentData} from 'react-simplified';
import ReactDOM from 'react-dom';

function timeout(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

class ItemStore {
  items = [];
  pending = true;

  async load() {
    this.pending = true;
    await timeout(500); // Simulate time-consuming task
    this.items = ['Orange', 'Apple', 'Lemon'];
    this.pending = false;
  }

  async add(item) {
    this.pending = true;
    await timeout(500); // Simulate time-consuming task
    this.items.push(item);
    this.pending = false;
  }

  async clear() {
    this.pending = true;
    await timeout(500); // Simulate time-consuming task
    this.items = [];
    this.pending = false;
  }
}
const itemStore = sharedComponentData(new ItemStore());
itemStore.load();

class ItemForm extends Component {
  newItem = '';

  setNewItem(event) {
    this.newItem = event.currentTarget.value;
  }

  async addNewItem() {
    await itemStore.add(this.newItem);
    this.newItem = '';
  }

  render() {
    return (
      <fieldset disabled={itemStore.pending}>
        <input type="text" value={this.newItem} onChange={this.setNewItem} />
        <button onClick={this.addNewItem}>Add item</button>
        <button onClick={itemStore.clear}>Clear items</button>
      </fieldset>
    );
  }
}

class ItemList extends Component {
  render() {
    return (
      <div style={{opacity: itemStore.pending ? '0.5' : '1.0'}}>
        <ul>{itemStore.items.map((item, i) => <li key={i}>{item}</li>)}</ul>
      </div>
    );
  }
}

ReactDOM.render(
  <div>
    <ItemForm />
    <ItemList />
  </div>,
  document.getElementById('root')
);
```

See
[examples/src/index.js](https://gitlab.com/eidheim/react-simplified/blob/master/examples/src/index.js) for additional code samples.
